{{- if not .Values.existingSecret }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "horizons.fullname" . }}
  labels:
    {{- include "horizons.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{- $dbUrl := include "horizons.databaseUrl" . }}
  {{- if $dbUrl }}
  DATABASE_URL: {{ $dbUrl | quote }}
  {{- end }}
  {{- $redisUrl := include "horizons.redisUrl" . }}
  {{- if $redisUrl }}
  REDIS_URL: {{ $redisUrl | quote }}
  {{- end }}
  {{- if .Values.features.vectorDbUrl }}
  HORIZONS_VECTOR_DB_URL: {{ .Values.features.vectorDbUrl | quote }}
  {{- end }}
  {{- if .Values.features.mcpConfig }}
  HORIZONS_MCP_CONFIG: {{ .Values.features.mcpConfig | quote }}
  {{- end }}
  {{- if .Values.secrets.masterKey }}
  HORIZONS_MASTER_KEY: {{ .Values.secrets.masterKey | quote }}
  {{- end }}
  {{- if .Values.features.daytonaApiKey }}
  DAYTONA_API_KEY: {{ .Values.features.daytonaApiKey | quote }}
  {{- end }}
  {{- if .Values.features.daytonaApiUrl }}
  DAYTONA_API_URL: {{ .Values.features.daytonaApiUrl | quote }}
  {{- end }}
{{- end }}
